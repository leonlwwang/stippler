(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const l of t.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function a(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function c(e){if(e.ep)return;e.ep=!0;const t=a(e);fetch(e.href,t)}})();const B=document.getElementById("file-btn"),k=document.getElementById("image-form");B.addEventListener("change",function(){k.remove();const r=new Image,i=B.files[0],a=new FileReader;a.readAsDataURL(i),a.onload=function(){r.src=a.result};const c=document.getElementById("handle"),e=document.createElement("div");e.className="loader";const t=document.createElement("div");t.className="wrapper",t.appendChild(e),document.body.insertBefore(t,c);const l=document.createElement("canvas");l.id="stippler",l.style.display="none",document.body.insertBefore(l,c);const m=document.getElementById("stippler").getContext("2d",{willReadFrequently:!0});r.onload=function(){const{width:p,height:g}=C(m,r,500),L=m.getImageData(0,0,p,g);m.drawImage(r,0,0,r.width,r.height,0,0,p,g);const D=m.getImageData(0,0,p,g),y=new Worker(new URL("/stippler/assets/worker-83d503dc.js",self.location),{type:"module"}),w=new Worker(new URL("/stippler/assets/worker-83d503dc.js",self.location),{type:"module"});let n=null,u=null;const P=new Date;y.postMessage({imageData:L,density:10,sharpness:100}),w.postMessage({imageData:D,density:10,sharpness:100}),y.onmessage=function(o){n=o.data,v()},w.onmessage=function(o){u=o.data,v()};function v(){if(n&&u){const o=new Date;t.remove();const d=document.createElement("p");d.textContent=u.length+n.length+" points generated in "+(o-P)/1e3+" sec",document.body.insertBefore(d,c),l.style.display="block",b(n),E(performance.now())}}function b(o){m.clearRect(0,0,p,g),m.fillStyle="black";for(let d=0,I=o.length;d<I;d+=2){const h=o[d],f=o[d+1];m.fillRect(h,f,1.1,1.1)}}const R=2e4;function E(o,d){const h=performance.now()-o,f=Math.min(h/R,1);for(let s=0,O=n.length;s<O;s+=2)n[s]=n[s]+(u[s]-n[s])*f,n[s+1]=n[s+1]+(u[s+1]-n[s+1])*f;b(n),f<1?requestAnimationFrame(()=>E(o)):console.log("animation complete")}}});function C(r,i,a){const c=Math.round(a*i.height/i.width);return r.canvas.width=a,r.canvas.height=c,{width:a,height:c}}
